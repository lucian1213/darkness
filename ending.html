<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>이 어둠을 당신과_엔딩 분기</title>
  <style>
    @font-face {
      font-family: 'GowunBatang';
      src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2108@1.1/GowunBatang-Regular.woff') format('woff');
      font-weight: normal;
      font-style: normal;
    }

    html, body {
      height: 100%;
      overflow: hidden; /* body 스크롤 금지 */
    }

    body {
      font-family: 'GowunBatang', serif;
      margin: 0;
      color: #fff;
      background: #000;
      font-size: 14px;
    }

    /* 🎯 배경: 블러된 cover + 원본 contain */
    .page-bg {
      position: fixed;
      inset: 0;
      z-index: -2;
      overflow: hidden; /* 블러 배경 삐져나가지 않게 */
    }
    .page-bg::before {
      content: "";
      position: absolute;
      inset: 0;
      background-image: url('');
      background-repeat: no-repeat;
      background-position: center center;
      background-size: cover;   /* 화면 전체 덮기 */
    }
    .page-bg::after {
      content: "";
      position: absolute;
      inset: 0;
      background-image: url('dark_phone.png');
      background-repeat: no-repeat;
      background-position: center 40%;
      background-size: 100% 97%; /* ✅ 원본 전체 보이게 */
      background-color: transparent;
    }

    /* 반투명 오버레이 */
    .bg-overlay {
      position: fixed;
      inset: 0;
      z-index: -1;
      background: rgba(0,0,0,0.6);
      pointer-events: none;
    }

    /* 고정 컨테이너: 화면 위~아래 사이에 고정 */
    .content-container {
      position: fixed;
      left: 50%;
      transform: translateX(-50%);
      top: 125px;      /* 위 여백 */
      bottom: 60px;    /* 아래 여백 */
      width: min(700px, 90vw);
      display: flex;
      flex-direction: column;
      border-radius: 10px;
      box-shadow: 0 2px 15px rgba(0, 0, 0, 0.5);
      background-color: rgba(30,30,30,0);
    }

    /* 내부 스크롤 영역 */
    .content-inner {
      flex: 1;
      overflow: auto;
      -webkit-overflow-scrolling: touch;
      padding: 20px;
      /* 페이드 애니메이션을 위한 설정 */
      transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out;
      opacity: 1;
      transform: translateY(0);
    }

    /* 페이드 아웃 클래스 */
    .fade-out {
      opacity: 0 !important;
      transform: translateY(-10px) !important;
    }

    /* 페이드 인 클래스 */
    .fade-in {
      opacity: 0;
      transform: translateY(10px);
      animation: fadeInUp 0.6s ease-out forwards;
    }

    @keyframes fadeInUp {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    h1 {
      color: #fff;
      text-align: center;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
      font-size: 1.5em;
      margin: 0 0 10px 0;
    }

    .subtitle {
      font-size: 0.9em;
      color: #ddd;
      text-align: center;
      margin: -4px 0 16px 0;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
    }

    .description {
      color: #ddd;
      font-size: 1em;
      line-height: 1.6;
      margin-bottom: 20px;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
      text-align: center;
    }

    .btn {
      background-color: #f2e2cc;
      color: #333;
      border: none;
      padding: 12px 25px;
      font-size: 14px;
      border-radius: 5px;
      cursor: pointer;
      display: block;
      margin: 30px auto 20px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
      transition: transform 0.2s, background-color 0.2s;
      font-family: 'GowunBatang', serif;
    }
    .btn:hover { background-color: #4b8be0; transform: translateY(-2px); }
    .btn:active { transform: translateY(1px); }

    /* 버튼 비활성화 상태 */
    .btn:disabled {
      background-color: #999;
      color: #666;
      cursor: not-allowed;
      transform: none;
    }
    .btn:disabled:hover {
      background-color: #999;
      transform: none;
    }

    /* 모바일 튜닝 */
    @media (max-width: 480px) {
      .content-inner { padding: 16px; }
      h1 { font-size: 1.4em; }
      .description { font-size: 0.95em; }
    }
  </style>
</head>
<body>
  <!-- 배경 + 오버레이 -->
  <div class="page-bg" aria-hidden="true"></div>
  <div class="bg-overlay" aria-hidden="true"></div>

  <!-- 고정된 컨테이너 -->
  <div class="content-container">
    <div class="content-inner" id="content">
      <h1>이 어둠을 당신과 엔딩 분기</h1>
     
      <div class="description">
        해당 페이지는 다같이 질문을 따라가며 해당하는 엔딩을<br>
        확인하는 페이지입니다.<br>
        각자의 대사는 해당하는 플레이어가 읽습니다.<br><br>
        모두 페이지에 접속했다면, 다음을 눌러 질문을 확인합니다.
      </div>

      <button id="next-button" class="btn">다음</button>
    </div>
  </div>

  <script>
    // 페이드 전환 함수
    function fadeTransition(newContent, callback) {
      const content = document.getElementById('content');
      
      // 현재 활성화된 버튼들 비활성화
      const buttons = content.querySelectorAll('button');
      buttons.forEach(btn => btn.disabled = true);
      
      // 페이드 아웃
      content.classList.add('fade-out');
      
      setTimeout(() => {
        // 내용 변경
        content.innerHTML = newContent;
        
        // 스크롤 위치를 맨 위로 초기화
        content.scrollTop = 0;
        
        // 페이드 아웃 클래스 제거하고 페이드 인 시작
        content.classList.remove('fade-out');
        content.classList.add('fade-in');
        
        // 콜백 함수 실행 (이벤트 리스너 등록)
        if (callback) {
          callback();
        }
        
        // 페이드 인 완료 후 클래스 제거
        setTimeout(() => {
          content.classList.remove('fade-in');
        }, 600);
      }, 500); // 페이드 아웃 시간과 동일
    }

    // 처음 화면으로 돌아가는 함수
    function goToInitialScreen() {
      const initialContent = `
        <h1>이 어둠을 당신과 엔딩 분기</h1>
       
        <div class="description">
          해당 페이지는 다같이 질문을 따라가며 해당하는 엔딩을<br>
          확인하는 페이지입니다.<br>
          각자의 대사는 해당하는 플레이어가 읽습니다.<br><br>
          모두 페이지에 접속했다면, 다음을 눌러 질문을 확인합니다.
        </div>

        <button id="next-button" class="btn">다음</button>
      `;
      
      fadeTransition(initialContent, () => {
        setupInitialScreen();
      });
    }

    // 처음 화면 이벤트 설정
    function setupInitialScreen() {
      document.getElementById('next-button').addEventListener('click', showQuestionScreen);
    }

    // 질문 화면 표시
    function showQuestionScreen() {
      const questionContent = `
        <h1>이 어둠을 당신과 엔딩 분기</h1>
      
        <div class="description">
          <strong>※ 질문</strong><br><br>
          자칭 탐정 리처드에게 질문입니다.<br>
          범인의 밀실 살인 방법은 무엇이었나요?<br>
          (리처드 답지의 Q3번 답안의 확인)<br><br>

          <strong>A. 악마 소환을 통해 밀실에서 빠져나왔다.</strong><br><br>

          <span style="font-size: 0.9em; color: #bbb;">
          ※ 의미상으로 「악마 소환을 통해 악마가 마법진 위로 이동하는 것을 이용하여 밀실을 빠져나왔다」 는 것을 지적해야 합니다.<br><br>
          따라서, 답변 내에 「악마 소환」 이나 「마법진」이라는 단어가 있더라도, 예를 들어 「어떤 악마의 힘으로 빠져나왔다」 혹은 「살해한 후 엘리자베스의 방에서 마법진을 그려 악마를 불러내어 밖으로 나가게 해달라고 했다」 등 다른 방법을 답한 경우는 오답으로 처리합니다.
          </span>
        </div>

        <div style="margin-top: 30px;">
          <button id="correct-answer" class="btn" style="margin-top:0; margin-bottom: 15px;">정답을 맞췄다</button>
          <button id="incorrect-answer" class="btn" style="margin-bottom: 30px;">정답을 맞추지 못했다</button>

          <div style="margin-top: 24px; border-top: 1px solid rgba(255,255,255,0.3); padding-top: 16px;">
            <button id="previous-branch" class="btn" style="margin-top: 10px;">이전 분기로</button>
          </div>
        </div>
      `;

      fadeTransition(questionContent, () => {
        setupQuestionScreen();
      });
    }

    // 질문 화면 이벤트 설정
    function setupQuestionScreen() {
      document.getElementById('correct-answer').addEventListener('click', showCorrectEnding);
      document.getElementById('incorrect-answer').addEventListener('click', showIncorrectEnding);
      document.getElementById('previous-branch').addEventListener('click', goToInitialScreen);
    }

    // 정답 엔딩
    function showCorrectEnding() {
      const correctContent = `
        <h1>이 어둠을 당신과 엔딩 분기</h1>
        
        <div class="description">
          갑자기, 자칭 탐정 리처드가 고개를 들었다. 아무것도 없는 공간을 바라보며, 그가 입을 연다. 그리고... 추리를 선보이기 시작했다.<br><br>

          <strong>자칭 탐정 리처드</strong> 「(다시 한 번, 당신이 생각한 진상(※투표 시의 답변과 동일한 것)을 발표해주세요. 설령 틀렸다고 생각하더라도, 자칭 탐정답게 당당하게 말해주세요. 추리 발표를 마치면 「이상이다」등으로 마무리해주세요.)」<br><br>

          엘리자베스를 죽인 그 방법이 무엇인지… 투표가 끝났다는데도, 갑자기 추리를 선보이는 자칭 탐정. 머리가 이상해진 걸까. 아니, 애초부터 이상했던 걸까?<br><br>

          중앙 홀에 불안한 기운이 가득 찬 그때였다. 그가 바라보고 있던 공간에, 하나의 그림자가 나타난다. 살랑살랑 움직이는 검은 그림자. 배경이 희미하게 비치면서도 분명히 존재하는 것. 그것은 인간이 아닌 것... 악마다.<br><br>

          나타난 악마는 쓴 표정을 지었다.<br><br>

          「아아, 유감스럽게도, 정답이다. 너 같은 자는 지옥에 떨어지는 편이 세상을 위해서, 사람들을 위해서 좋을 텐데...」<br><br>

          악마는 투덜거린 후, 크게 한숨을 내쉬었다.<br><br>

          「뭐, 어쩔 수 없지. 이건 그런 놀이니까, 승자에게는 상을 줘야만 한다. 너에게 영원한 생명을 주겠다. 그 몸은 썩지 않을 것이다. 끝나지 않는 생명을 후회해도 난 모른다.」<br><br>

          그렇게 말을 마치자, 악마는 시시하다는 듯한 표정을 지으며 사라졌다.
        </div>

        <div style="margin-top: 30px;">
          <button id="next-step" class="btn">다음</button>
          
          <div style="margin-top: 24px; border-top: 1px solid rgba(255,255,255,0.3); padding-top: 16px;">
            <button id="previous-branch" class="btn" style="margin-top: 10px;">이전 분기로</button>
          </div>
        </div>
      `;

      fadeTransition(correctContent, () => {
        document.getElementById('next-step').addEventListener('click', () => {
          alert('다음 단계로 진행합니다.');
        });
        document.getElementById('previous-branch').addEventListener('click', goToInitialScreen);
      });
    }

    // 오답 엔딩
    function showIncorrectEnding() {
      const incorrectContent = `
        <h1>이 어둠을 당신과 엔딩 분기</h1>
        
        <div class="description">
          갑자기, 자칭 탐정 리처드가 고개를 들었다. 아무것도 없는 공간을 바라보며, 그가 입을 연다. 그리고... 추리를 선보이기 시작했다.<br><br>

          엘리자베스를 죽인 그 방법이 무엇인지… 투표가 끝났다는데도, 갑자기 추리를 선보이는 자칭 탐정. 머리가 이상해진 걸까. 아니, 애초부터 이상했던 걸까?<br><br>

          중앙 홀에 불안한 기운이 가득 찬 그때였다. 그가 바라보고 있던 공간에, 하나의 그림자가 나타난다. 살랑살랑 움직이는 검은 그림자. 배경이 희미하게 비치면서도 분명히 존재하는 것. 그것은 인간이 아닌 것... 악마다.<br><br>

          나타난 악마는, 미소를 지으며 어깨를 으쓱했다.<br><br>

          「아아, 유감이군. 보아하니, 자네는 밀실의 수수께끼를 풀어내지 못했나 보군. 이 놀이는 자네의 패배다. 자네의 영혼을 본래의 순환으로 되돌리지. 즉... 자네는 지옥에 떨어진다는 뜻이지. 그것도, 지옥 중에서도 가장 고통스러운 곳으로 떨어지겠지. 지옥의 망자들이 기쁘게 자네를 기다리고 있다고.」<br><br>

          악마는, 여전히 아름다운 미소를 띠고 있다.<br><br>

          자칭 탐정 리처드는, 자신의 영혼이 몸에서 벗겨져 나가는 감각을 느낀다. 그것은 현실과 꿈을 오가는 듯한 기분. 천천히 추락하기 시작하는 것처럼. 하지만 아직, 의식은 여기에 남아있다.
        </div>

        <div style="margin-top: 30px;">
          <button id="next-step" class="btn">다음</button>
          
          <div style="margin-top: 24px; border-top: 1px solid rgba(255,255,255,0.3); padding-top: 16px;">
            <button id="previous-branch" class="btn" style="margin-top: 10px;">이전 분기로</button>
          </div>
        </div>
      `;

      fadeTransition(incorrectContent, () => {
        document.getElementById('next-step').addEventListener('click', () => {
          alert('다음 단계로 진행합니다.');
        });
        document.getElementById('previous-branch').addEventListener('click', showQuestionScreen);
      });
    }

    // 초기 로드 시 이벤트 설정
    document.addEventListener('DOMContentLoaded', function() {
      setupInitialScreen();
    });
  </script>
</body>
</html>
